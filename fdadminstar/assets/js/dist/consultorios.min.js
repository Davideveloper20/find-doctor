"use strict";moment().locale("es");var map,infoWindow,geocoder,curLat=0,curLon=0,marker=!1,geocodePosition=function(a){geocoder.geocode({latLng:a},function(a){if(a&&0<a.length){console.log("geocodePosition",a);var b={};marker.formatted_address=a[0].formatted_address;var c=a[0].formatted_address;$("#address").val(c),c="",a[0].address_components.forEach(function(a){"country"==a.types[0]&&(b.country=a.long_name),"administrative_area_level_1"==a.types[0]&&(b.region=a.long_name),"administrative_area_level_2"==a.types[0]&&(b.city=a.long_name),"locality"==a.types[0]&&(c+=(""==c?"":", ")+a.long_name),"neighborhood"==a.types[0]&&(c+=(""==c?"":", ")+a.long_name),"route"==a.types[0]&&(c+=(""==c?"":", ")+a.long_name),"street_number"==a.types[0]&&(c+=(""==c?"":", ")+a.long_name)}),console.log("addre",c),solstar.ajaxRequest(`l/${b.country}/${b.region}/${b.city}`,"GET",function(a){a.success&&0<a.data.length&&($("#idcity").val(a.data[0].item),$("#idcityval").val(a.data[0].id))},{},!0,null,function(){})}else marker.formatted_address="Cannot determine address at this location.",$("#address").val("Cannot determine address at this location.")})},toggleBounce=function(){null===marker.getAnimation()?marker.setAnimation(google.maps.Animation.BOUNCE):marker.setAnimation(null)},currGeo=function(a){console.log("currGeo",a),curLat=parseFloat(a.latitude),curLon=parseFloat(a.longitude),$("#latitude").val(curLat),$("#longitude").val(curLon),initMap()},redrawDt=function(){$("#dtDatatable .editConsultinR").off("click").on("click",function(){var a=$(this),b=a.data();console.log(".editFormation",b),solstar.ajaxRequest("ConsultoriosSave","PATCH",function(a){a.success?(console.log(a),$("#modalDocEduc #saveFormation").data("type",1),$("#modalDocEduc #saveFormation").data("reqid",a.data.id),$("#modalDocEduc #name").val(a.data.name),$("#modalDocEduc #idcity").val(a.data.city+", "+a.data.state+", "+a.data.country),$("#modalDocEduc #idcityval").val(a.data.idcityval),$("#modalDocEduc #address").val(a.data.address),$("#modalDocEduc #phone1").val(a.data.phone1),$("#modalDocEduc #phone2").val(a.data.phone2),$("#modalDocEduc #email").val(a.data.email),$("#modalDocEduc #url").val(a.data.url),$("#modalDocEduc #latitude").val(a.data.latitud),$("#modalDocEduc #longitude").val(a.data.longitud),$("#modalDocEduc .modal-title").html("<i class=\"fa fa-edit fa-fw\"></i> Editar Consultorio"),$("#modalDocEduc #saveFormation").html("<i class=\"fa fa-save\"></i> Guardar"),$("#modalDocEduc").modal({show:!0,backdrop:"static",keyboard:!1})):alertify.warning(a.message,10)},{id:b.id||-1},!0,null,function(a){alertify.warning("Ha ocurrido un error! "+(a.message||""),10)})})},initMap=function(){geocoder=new google.maps.Geocoder;var a=parseFloat($("#latitude").val()||curLat),b=parseFloat($("#longitude").val()||curLon);console.log("initMap",{lat:a,lng:b}),map=new google.maps.Map(document.getElementById("map"),{center:new google.maps.LatLng(a,b),zoom:12}),console.log("init marker");var c=new google.maps.MarkerImage(solstar.Almacen_fi+"assets/images/icon.png",new google.maps.Size(71,71),new google.maps.Point(0,0),new google.maps.Point(17,34),new google.maps.Size(35,35));marker=new google.maps.Marker({position:{lat:a,lng:b},map:map,title:"Esta Aqui!",draggable:!0,animation:google.maps.Animation.DROP,icon:c}),marker.addListener("click",toggleBounce),google.maps.event.addListener(marker,"dragend",function(){console.log("Drag ended");let a=marker.getPosition();$("#latitude").val(a.lat()),$("#longitude").val(a.lng()),geocodePosition(a)})};$.getScript("https://maps.googleapis.com/maps/api/js?v=3&key=AIzaSyDg2Z6QWeOzf4FkS5ZYQx2Isw6efT90dHI&libraries=geometry&callback=initMap"),$(function(){solstar.autocomplete($("#idcity","#modalDocEduc")[0],cities,$("#idcityval","#modalDocEduc")[0]),$("#modalDocEduc").on("hide.bs.modal",function(){$("input, textarea","#modalDocEduc .modal-body").val(""),$("#modalDocEduc .modal-title").html("<i class=\"fa fa-plus fa-fw\"></i>Agregar Consultorio"),$("#modalDocEduc #saveFormation").html("<i class=\"fa fa-save\"></i> Guardar"),$("#modalDocEduc #saveFormation").data("type",0),$("#modalDocEduc #saveFormation").data("reqid","")}),$("#modalDocEduc").on("show.bs.modal",function(){""==$("#saveFormation").data("reqid")?$.getScript("https://get.geojs.io/v1/ip/geo.js?callback=currGeo"):initMap()}),$("#saveFormation").off("click").on("click",function(){if($("#addConsultingRoom-frm").validate(),$("#addConsultingRoom-frm").valid()){var a={name:$("#modalDocEduc #name").val(),idconsult:$("#modalDocEduc #idconsult").val(),idcity:$("#modalDocEduc #idcityval").val(),city:$("#modalDocEduc #idcity").val(),address:$("#modalDocEduc #address").val(),phone1:$("#modalDocEduc #phone1").val(),phone2:$("#modalDocEduc #phone2").val(),email:$("#modalDocEduc #email").val(),url:$("#modalDocEduc #url").val(),latitude:$("#modalDocEduc #latitude").val(),longitude:$("#modalDocEduc #longitude").val()};1==$("#modalDocEduc #saveFormation").data("type")&&(a.id=$("#modalDocEduc #saveFormation").data("reqid")),solstar.ajaxRequest("ConsultoriosSave",1==$("#modalDocEduc #saveFormation").data("type")?"PUT":"POST",function(a){a.success?location.reload():alertify.warning("Ha ocurrido un error! "+a.message,10)},a,!0,null,function(a){alertify.warning("Ha ocurrido un error! "+(a.message||""),10)})}});solstar.dataTableReq({el:"#dtDatatable",dataSource:function(a){a=a.data;for(var b=0,c=a.length;b<c;b++){a[b].num=b+1,a[b].phone1="<i class=\"fa fa-phone fa-fw\" aria-hidden=\"true\"></i><a href=\"tel:"+a[b].phone1+"\" target=\"_blank\">"+a[b].phone1+"</a>"+(a[b].phone2&&""!=a[b].phone2?"<hr><i class=\"fa fa-phone fa-fw\" aria-hidden=\"true\"></i><a href=\""+a[b].phone2+"\" target=\"_blank\">"+a[b].phone2+"</a>":""),a[b].email="<i class=\"fa fa-envelope fa-fw\" aria-hidden=\"true\"></i><a href=\"mailto:"+a[b].email+"\" target=\"_blank\">"+a[b].email+"</a>";let c=a[b].address;a[b].address="<i class=\"fa fa-map-marker-alt fa-fw\" aria-hidden=\"true\"></i>"+a[b].address+"<hr><div class=\"col-lg-12 rflex\">",a[b].address+="<a class=\"btn btn-info btn-sm mx-2\" href=\"https://waze.com/ul?q="+encodeURIComponent(c+" "+a[b].city+" "+a[b].state+" "+a[b].country)+"&z=8&navigate=yes&zom=8\" class=\"button link external rflex\"><i class=\"fab fa-waze\"></i></a>",a[b].address+="<a class=\"btn btn-info btn-sm mx-2\" href=\"https://www.google.com/maps/dir/?api=1&destination="+encodeURIComponent(c+" "+a[b].city+" "+a[b].state+" "+a[b].country)+"&travelmode=transit&dir_action=navigate\" class=\"button link external rflex\"><i class=\"fas fa-map-marked-alt\"></i></a></div>",a[b].actions="<a href=\"javascript:void('"+a[b].id+"')\" class=\"btn btn-primary btn-sm editConsultinR\" data-toggle=\"popover\" title=\"Editar\" data-content=\""+a[b].name+"\" data-id=\""+a[b].id+"\"><i class=\"fa fa-edit\"></i></a>"}return a},redrawFunction:redrawDt,columnDefs:[{targets:0,searchable:!1}],columns:[{data:"num"},{data:"name"},{data:"address"},{data:"email"},{data:"phone1"},{data:"actions"}],url:"ConsultoriosSave",typeMethod:"GET"})});
//# sourceMappingURL=maps/consultorios.min.js.map

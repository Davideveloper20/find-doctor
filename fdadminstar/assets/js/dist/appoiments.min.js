"use strict";$("#myCalendardhxtml, #scheduler_here").css({minHeight:$(window).outerHeight()-125}),moment().locale("es"),$(function(){var a=function(a){console.log("changeserv",a),$("#idserviceval").val(a.item.id),$("#idserviceval").data("id",a.item.id),$("#idserviceval").data("amount",a.item.amount),$("#idserviceval").data("selamount",a.item.amount),$("#idserviceval").data("amount-prepaid",a.item.amount_prepaid),$("#idserviceval").data("duration",a.item.duration),$("#prepaidstatus")[0].checked=!1,$("#service_amount").val(a.item.amount),$("#duration").html("<option value=\"0\">Seleccione...</option>");for(var b=1;5>b;b++){let c=a.item.duration*b,d=moment(new Date(1986,5,17,0,0,0)).add(c,"minutes").format(60<=c?"hh:mm":"mm")+(60<=c?" hora":" minutos");$("#duration").append(`<option value="${a.item.duration*b}">${d}</option>`)}};solstar.autocomplete($("#idservice","#event_form")[0],docservices,$("#idserviceval","#event_form")[0],a),console.log("optionCalBD",optionCalBD);var b=function(a){return document.getElementById(a)},c=scheduler.date.date_to_str("%H:%i"),d=function(){solstar.jqc_alert("Eliminar Agendamiento!","\xBFConfirma que desea eliminar <b>DEFINITIVAMENTE</b> este agendamineto?","modern","fa fa-times","red",{Cancelar:function(){},"Si, Eliminar!":function(){var a=scheduler.getState().lightbox_id;scheduler.endLightbox(!1,b("event_form")),scheduler.deleteEvent(a),$("#event_form").modal("hide")}})};scheduler.showLightbox=function(c){var e=scheduler.getEvent(c);if(scheduler.startLightbox(c,b("event_form")),console.log("showLightbox",e),$("#duration").val(0),$("#patienname, #type_doc, #document, #idservice, #idserviceval, #details").val(""),"undefined"==typeof e.apment_date){$("#prepaidstatus")[0].checked=!1,$("#deleteAppoint").fadeOut(),$("#deleteAppoint").off("click"),$("#event_form #event_formtitle").html("Agendar Nueva Cita");let a=moment(e.start_date).minute();0<=a&&15>a?a=0:15<=a&&30>a?a=15:30<=a&&45>a?a=30:45<=a&&(a=45),e.start_date.setMinutes(a),$("#idserviceval").data("newevent",1),$("#stautacont").hide(),$("#status").val(1)}else $("#idserviceval").data("newevent",0),$("#deleteAppoint").fadeIn(),$("#stautacont").show(),$("#deleteAppoint").off("click").on("click",d),$("#event_form #event_formtitle").html("Editar: "+e.title),$("#prepaidstatus")[0].checked=1==e.prepaid,$("#patienname").val(e.name),$("#type_doc").val(e.type_doc),$("#status").val(e.idstatus),$("#document").val(e.document),$("#document").data("id",e.idpatient),$("#idservice").val(`${e.service}, ${e.serv_duration} minutos`),$("#idserviceval").val(e.idservice),$("#details").val(e.details),a({item:{id:e.idservice,amount:e.serv_amount,amount_prepaid:e.serv_amount_prepaid,duration:e.serv_duration}}),$("#duration").val((e.end_date-e.start_date)/1e3/60),$("#service_amount").val(e.amount);$("#idserviceval").data("start_date",e.start_date),$("#apment_date").val(moment(e.start_date).format("DD/MM/YYYY")),$("#start_at").val(moment(e.start_date).format("hh:mm A")),$("#event_form").modal({backdrop:"static",show:!0,keyboard:!1,focus:!1}),$("#event_form").css("top","0px !important")},$("#event_form #saveAppoint").on("click",function(){var a=scheduler.getEvent(scheduler.getState().lightbox_id);a.document=$("#document").val()||"",a.type_doc=$("#type_doc").val()||"",a.idpatient=$("#document").data("id")||"",a.patienname=$("#patienname").val()||"",a.name=$("#patienname").val()||"",a.idservice=$("#idserviceval").val()||"",a.prepaid=($("#prepaidstatus")[0].checked?1:0)||0,a.amount=$("#service_amount").val()||"0.00",a.duration=$("#duration").val()||"15",a.details=$("#details").val()||"Ninguna";var b=$("#idserviceval").data("start_date");a.apment_date=moment(b).format("YYYY-MM-DD"),a.start_at=moment(b).format("HH:mm"),a.end_at=moment(b).add(a.duration,"minutes").format("HH:mm"),a.newevent=$("#idserviceval").data("newevent"),a.status=1==a.newevent?"1":$("#status").val(),console.log(a),a.start_date=moment(b).format("YYYY-MM-DD HH:mm"),a.end_date=moment(b).add(a.duration,"minutes").format("YYYY-MM-DD HH:mm"),a.apment_date=moment(b).format("YYYY-MM-DD");var c=a.id;console.log("eventId",c);let d=`Doctor/AppoinmentsSave${1==a.newevent?"":"/"+scheduler.getState().lightbox_id}`;solstar.ajaxRequest(d,1==a.newevent?"POST":"PUT",function(b){b.success?(alertify.warning("Agendamiento "+(1==a.newevent?"realizado":"actualizado")+"!",10),b.data.start_date=new Date(b.data.start_date),b.data.end_date=new Date(b.data.end_date),a.start_date=b.data.start_date,a.end_date=b.data.end_date,$.extend(!0,scheduler.getEvent(c),b.data),scheduler.updateEvent(c),console.log("resp.data",b.data),$("#event_form").modal("hide"),scheduler.endLightbox(!0,$("#event_form")[0])):alertify.warning(b.message,10)},a,!0,null,function(a){alertify.warning("Ha ocurrido un error! "+(a.message||""),10)})}),$("#event_form .closeModal").on("click",function(){$("#event_form").modal("hide"),scheduler.endLightbox(!1,b("event_form"))}),$("#type_doc, #document").on("change",function(){var a=$("#document").val()||"",b=$("#type_doc").val()||"";console.log("patient",a,b),""!=a&&""!=b&&($("#patienname").val(""),$("#patienname").data("id",!1),solstar.ajaxRequest(`Patient/Search/${b}/${a}`,"POST",function(a){a.success&&0<a.data.length?($("#patienname").val(a.data[0].name),$("#patienname").data("id",a.data[0].id),$("#document").data("id",a.data[0].id)):!a.success&&alertify.warning(a.message,10)},{},!0,null,function(a){alertify.warning("Ha ocurrido un error! "+(a.message||""),10)}))}),$("#duration").on("change",function(){var a=0;this.checked?($("#idserviceval").data("selamount",$("#idserviceval").data("amount-prepaid")),a=$("#idserviceval").data("amount-prepaid")):($("#idserviceval").data("selamount",$("#idserviceval").data("amount")),a=$("#idserviceval").data("amount"));var b=$("#duration").val(),c=$("#idserviceval").data("duration"),d=a*(b/c);console.log("duration",{duration:b,inter:c,selam:a,clcam:d}),$("#service_amount").val(d)}),$("#prepaidstatus").on("change",function(){var a=0;this.checked?($("#idserviceval").data("selamount",$("#idserviceval").data("amount-prepaid")),a=$("#idserviceval").data("amount-prepaid")):($("#idserviceval").data("selamount",$("#idserviceval").data("amount")),a=$("#idserviceval").data("amount"));var b=$("#prepaidstatus").val();console.log("prepaidstatus",b,this.checked);var c=$("#duration").val(),d=$("#idserviceval").data("duration"),e=a*(c/d);console.log("prepaidstatus",{prepaidstatus:this.checked,duration:c,inter:d,selam:a,clcam:e}),$("#service_amount").val(e)});$.extend(!0,scheduler,{config:{icons_select:["icon_edit","icon_details","icon_delete"],update_render:!0,start_on_monday:!1,hour_date:"%h:%i %A",hour_size_px:170,prevent_cache:!0,first_hour:parseInt(optionCalBD.profile.time_start.split(":")[0]||"8"),last_hour:parseInt(optionCalBD.profile.time_end.split(":")[0]||"17"),drag_in:!1,drag_out:!1,drag_resize:!1,drag_move:!1,limit_time_select:!0,details_on_create:!0,details_on_dblclick:!0,multi_day:!0},xy:{scale_width:70,scale_height:40},templates:{hour_scale:function(a){for(var b=15,d="",e=170/(60/b),f=0;f<60/b;f++)d+="<div style='height:"+e+"px;line-height:"+e+"px;'>"+c(a)+"</div>",a=scheduler.date.add(a,b,"minute");return d},week_date_class:function(){return"custom_color"}}}),scheduler.init("scheduler_here",new Date,"week"),scheduler.load(`${almacen}Doctor/AppoinmentsList`,function(){});var e=new dataProcessor(`${almacen}Doctor/AppoinmentsSave`);e.init(scheduler),e.setTransactionMode("REST",!1)});
//# sourceMappingURL=maps/appoiments.min.js.map
